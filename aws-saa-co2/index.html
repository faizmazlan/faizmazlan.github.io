
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title id="PageTitle">Exam Practice</title>

    <!-- Bootstrap core CSS -->
    <link href="https://getbootstrap.com/docs/4.1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles -->
    <style type="text/css" media="all">
        .container { max-width: 960px; }
        .lh-condensed { line-height: 1.25; }
        .pager { margin:5px 0 5px; color:#999; text-align:right; font-size: 14px; }
        .question { margin:5px 0 5px; font-size: 12px; }
    </style>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- JS quiz variables - start -->
<script>
    /*
var xhttp = new XMLHttpRequest();
xhttp.open("GET", "quiz.json", true);
xhttp.send();

var Quiz = xhttp.responseText;
var QuizCode = Quiz['QuizCode'];
var QuizTitle = Quiz['QuizTitle'];
var QuizDescription = Quiz['QuizDescription'];
var QuizQuestions = Quiz['QuizQuestions'];

    var QuizCode = Quiz.QuizCode;
    var QuizTitle = Quiz.QuizTitle;
    var QuizDescription = Quiz.QuizDescription;
    var QuizQuestions = Quiz.QuizQuestions;   
*/
</script>
<!-- JS quiz variables - end -->

<!-- JS quiz functions - start -->
<script>

var 
    QuizCurrentQuestions = 0 ,
    QuizScore = [] ,
    QuizScoreSum = 0 ,
    QuizScorePercent = 0 ,
	QuizSubmit = true ,
    QuizPicked ;

jQuery(document).ready(function ($) {

	function htmlEncode(value) {
		return $(document.createElement('div')).text(value).html();
    }

    function checkAnswer(choices) {
        var QuizCorrectAnswersCount = 0
        for (var i = 0; i < choices.length; i++) {
            $('#AnswerBlock'+choices[i].id).removeClass('btn-success');
            $('#AnswerBlock'+choices[i].id).removeClass('btn-danger');
        }

        if (!!localStorage.getItem('SelectedAnswerStore'+QuizCurrentQuestions)){
            var SelectedAnswerStoreArray = localStorage.getItem('SelectedAnswerStore'+QuizCurrentQuestions).split(',');
            for (var SelectedAnswer of SelectedAnswerStoreArray) {
                if(!QuizQuestions[QuizCurrentQuestions]['correct'].includes(SelectedAnswer)){
                    $('#AnswerInput'+SelectedAnswer).attr('checked', 'checked');
                    $('#AnswerBlock'+SelectedAnswer).addClass('btn-danger');
                } else {
                    $('#AnswerBlock'+SelectedAnswer).addClass('btn-success');
                    QuizCorrectAnswersCount++;
                }
            }
        }

        if ( QuizCorrectAnswersCount == QuizQuestions[QuizCurrentQuestions]['correct'].length ){
            QuizScore[QuizCurrentQuestions] = 1;
            // alert('Correct answer!');
        } else if ( QuizCorrectAnswersCount < QuizQuestions[QuizCurrentQuestions]['correct'].length ){
            QuizScore[QuizCurrentQuestions] = 0;
            // alert('Insufficient correct answer!');
        } else {
            QuizScore[QuizCurrentQuestions] = 0;
            // alert('Wrong answer!');
        }
        QuizScoreSum = QuizScore.reduce(function(a, b){ return a + b; }, 0);
        QuizScorePercent = (QuizScoreSum/QuizQuestions.length)*100
    }
    
    function getSelectedAnswers(){
        var SelectedAnswers = $("input[name='QuizAnswer"+QuizCurrentQuestions+"']:checked")
        if (!!SelectedAnswers){
            var SelectedAnswersArray = []
            for (var SelectedAnswer of SelectedAnswers) {
                SelectedAnswersArray.push(SelectedAnswer.value);
            }
            localStorage.setItem('SelectedAnswerStore'+QuizCurrentQuestions, SelectedAnswersArray.join(','));
        }
    }

	function addChoices(choices) {
        var CorrectAnswersCount = QuizQuestions[QuizCurrentQuestions]['correct'].length
    
		if (typeof choices !== "undefined" && $.type(choices) == "array") {
			$('#ChoiceBlock').empty();
            if( CorrectAnswersCount > 1 ){
                for (var i = 0; i < choices.length; i++) {
                    $(document.createElement('div')).addClass('custom-control').addClass('custom-checkbox').attr('id', 'AnswerBlock' + choices[i].id).appendTo('#ChoiceBlock');
                    $(document.createElement('input')).addClass('custom-control-input').attr('name', 'QuizAnswer'+QuizCurrentQuestions).attr('type', 'checkbox').attr('id', 'AnswerInput' + choices[i].id).attr('value', choices[i].id).appendTo('#AnswerBlock' + choices[i].id);
                    $(document.createElement('label')).addClass('custom-control-label').attr('id', 'AnswerLabel' + choices[i].id).attr('for', 'AnswerInput' + choices[i].id).appendTo('#AnswerBlock' + choices[i].id);
                    $(document.createElement('b')).text('[ ' + choices[i].id + ' ]  ').appendTo('#AnswerLabel' + choices[i].id);
                    $(document.createElement('span')).text(choices[i].text).appendTo('#AnswerLabel' + choices[i].id);
                }
            } else {
                for (var i = 0; i < choices.length; i++) {
                    $(document.createElement('div')).addClass('custom-control').addClass('custom-radio').attr('id', 'AnswerBlock' + choices[i].id).appendTo('#ChoiceBlock');
                    $(document.createElement('input')).addClass('custom-control-input').attr('name', 'QuizAnswer'+QuizCurrentQuestions).attr('type', 'radio').attr('required', '').attr('id', 'AnswerInput' + choices[i].id).attr('value', choices[i].id).appendTo('#AnswerBlock' + choices[i].id);
                    $(document.createElement('label')).addClass('custom-control-label').attr('id', 'AnswerLabel' + choices[i].id).attr('for', 'AnswerInput' + choices[i].id).appendTo('#AnswerBlock' + choices[i].id);
                    $(document.createElement('b')).text('[ ' + choices[i].id + ' ]  ').appendTo('#AnswerLabel' + choices[i].id);
                    $(document.createElement('span')).text(choices[i].text).appendTo('#AnswerLabel' + choices[i].id);
                }
            }

            if (!!localStorage.getItem('SelectedAnswerStore'+QuizCurrentQuestions)){
                var SelectedAnswerStoreArray = localStorage.getItem('SelectedAnswerStore'+QuizCurrentQuestions).split(',');
                for (var SelectedAnswer of SelectedAnswerStoreArray) {
                    $('#AnswerInput'+SelectedAnswer).attr('checked', 'checked');
                }
            }
		}
    }

    function setButtons(choices) {
        $(document.createElement('div')).addClass('col').attr('id', 'ButtonCol1').appendTo('#QuizButton');
        $(document.createElement('div')).addClass('col').attr('id', 'ButtonCol2').appendTo('#QuizButton');
        $(document.createElement('div')).addClass('col').attr('id', 'ButtonCol3').appendTo('#QuizButton');

        switch (QuizCurrentQuestions) {
            case QuizQuestions.length-1:
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-secondary').attr('id', 'ButtonPrev').text('Prev').appendTo('#ButtonCol1');
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-light').attr('id', 'ButtonCheck').text('Check').appendTo('#ButtonCol2');
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-success').attr('id', 'ButtonFinish').attr('type', 'submit').text('Finish').appendTo('#ButtonCol3');
                break;
            case 0:
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-light').attr('id', 'ButtonPrev').text('Prev').appendTo('#ButtonCol1');
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-light').attr('id', 'ButtonCheck').text('Check').appendTo('#ButtonCol2');
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-primary').attr('id', 'ButtonNext').attr('type', 'submit').text('Next').appendTo('#ButtonCol3');
                $('#ButtonPrev').attr('disabled', 'disabled');
                break;
            default:
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-secondary').attr('id', 'ButtonPrev').text('Prev').appendTo('#ButtonCol1');
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-light').attr('id', 'ButtonCheck').text('Check').appendTo('#ButtonCol2');
                $(document.createElement('button')).addClass('btn btn-block').addClass('btn-primary').attr('id', 'ButtonNext').attr('type', 'submit').text('Next').appendTo('#ButtonCol3');
        }

        $('#ButtonNext').on('click', function () {
            getSelectedAnswers();
            checkAnswer(QuizQuestions[QuizCurrentQuestions]['choices']);
            QuizCurrentQuestions++; 
            getQuestion(); 
        });
        $('#ButtonPrev').on('click', function () {
            getSelectedAnswers();
            checkAnswer(QuizQuestions[QuizCurrentQuestions]['choices']);
            QuizCurrentQuestions--;
            getQuestion();
        });
        $('#ButtonCheck').on('click', function () {
            getSelectedAnswers();
            checkAnswer(QuizQuestions[QuizCurrentQuestions]['choices']);
        });
        $('#ButtonFinish').on('click', function () {
            getSelectedAnswers();
            checkAnswer(QuizQuestions[QuizCurrentQuestions]['choices']);
            getResult();
        });
    }

    function getQuestion() {
        $('#QuizExplanation').empty();
        $('#QuizButton').empty();
        $('#QuizQuestion').text(QuizQuestions[QuizCurrentQuestions]['question']);
        $('#QuizPager').text('Question ' + Number(QuizCurrentQuestions + 1) + ' of ' + QuizQuestions.length);
        if (QuizQuestions[QuizCurrentQuestions].hasOwnProperty('image') && QuizQuestions[QuizCurrentQuestions]['image'] != "") {
            if ($('#question-image').length == 0) {
                $(document.createElement('img')).addClass('question-image').attr('id', 'question-image').attr('src', QuizQuestions[QuizCurrentQuestions]['image']).attr('alt', htmlEncode(QuizQuestions[QuizCurrentQuestions]['question'])).insertAfter('#question');
            } else {
                $('#question-image').attr('src', QuizQuestions[QuizCurrentQuestions]['image']).attr('alt', htmlEncode(QuizQuestions[QuizCurrentQuestions]['question']));
            }
        } else {
            $('#question-image').remove();
        }
        addChoices(QuizQuestions[QuizCurrentQuestions]['choices']);
        setButtons();

        jQuery(document).ready(function ($) {
            $("#QuizQuestion").html(function () {
                var text = $(this).text().trim().split(" ");
                var first = text.shift();
                return (text.length > 0 ? "<span class='number'>" + first + "</span> " :
                    first) + text.join(" ");
            });

            $("#QuizPager").each(function () {
                var text = $(this).text().split(' ');
                if (text.length < 2)
                    return;

                text[1] = '<span class="qnumber">' + text[1] + '</span>';
                $(this).html(
                    text.join(' ')
                );
            });
        });
    }

    function getResult() {
        $('#QuizExplanation').empty();
        $('#QuizButton').empty();
        $('#QuizQuestion').empty();
        $('#QuizPager').empty();
        $('#QuizContent').empty();
        $(document.createElement('hr')).addClass('mb-4').appendTo('#QuizContent');
        if ( QuizScorePercent > 80 ) {
            $(document.createElement('h2')).addClass('text-center text-success').text('Congratulations!').appendTo('#QuizContent');
            $(document.createElement('h4')).addClass('text-center text-secondary').text('You scored '+QuizScorePercent.toFixed(2)+'%').appendTo('#QuizContent');
        } else {
            $(document.createElement('h2')).addClass('text-center text-danger').text('Try Again').appendTo('#QuizContent');
            $(document.createElement('h4')).addClass('text-center text-secondary').text('You scored '+QuizScorePercent.toFixed(2)+'%').appendTo('#QuizContent');
        }
        $(document.createElement('br')).appendTo('#QuizContent');
        $(document.createElement('div')).addClass('row').attr('id', 'QuizStartRow1').appendTo('#QuizContent');
        $(document.createElement('div')).addClass('col').attr('id', 'QuizStartCol11').appendTo('#QuizStartRow1');
        $(document.createElement('div')).addClass('col').attr('id', 'QuizStartCol12').appendTo('#QuizStartRow1');
        $(document.createElement('div')).addClass('col').attr('id', 'QuizStartCol13').appendTo('#QuizStartRow1');
        $(document.createElement('button')).addClass('btn btn-block').addClass('btn-secondary').attr('id', 'ButtonRevisit').text('Revisit').appendTo('#QuizStartCol12');
        $('#ButtonRevisit').on('click', function () {
            startQuiz(0);
        });
        $(document.createElement('button')).addClass('btn btn-block').addClass('btn-primary').attr('id', 'ButtonStart').text('Start Over').appendTo('#QuizStartCol12');
        $('#ButtonStart').on('click', function () {
            localStorage.clear();
            window.location.reload();
        });
        $(document.createElement('hr')).addClass('mb-4').appendTo('#QuizContent');
    }

    function startQuiz(CurrentQuestion) {

        if ( typeof CurrentQuestion !== "undefined" ){
            QuizCurrentQuestions = CurrentQuestion
        }

        $('#QuizContent').empty();

		//add pager and questions
		if (typeof QuizQuestions !== "undefined" && $.type(QuizQuestions) === "array") {
			//add pager
            $(document.createElement('p')).addClass('pager').attr('id', 'QuizPager').text('Question 1 of ' + QuizQuestions.length).appendTo('#QuizContent');
            $(document.createElement('hr')).addClass('mb-4').appendTo('#QuizContent');

			//add first question
			//$(document.createElement('p')).addClass('question').attr('id', 'QuizQuestion').text(QuizQuestions[0]['question']).appendTo('#QuizContent');
			$(document.createElement('p')).attr('id', 'QuizQuestion').text(QuizQuestions[0]['question']).appendTo('#QuizContent');
            
            //add image if present
            /*
			if (QuizQuestions[0].hasOwnProperty('image') && QuizQuestions[0]['image'] != "") {
				$(document.createElement('img')).addClass('question-image').attr('id', 'question-image').attr('src', QuizQuestions[0]['image']).attr('alt', htmlEncode(QuizQuestions[0]['question'])).appendTo('#QuizContent');
            }
            */

			//add explaination
            /*
			$(document.createElement('p')).addClass('explanation').attr('id', 'QuizExplanation').html('').appendTo('#QuizContent');
            */

			//choices block
			$(document.createElement('div')).attr('id', 'ChoiceBlock').appendTo('#QuizContent');

			//add choices
            addChoices(QuizQuestions[QuizCurrentQuestions]['choices']);

            // button blocks
            $(document.createElement('hr')).addClass('mb-4').appendTo('#QuizContent');
            $(document.createElement('div')).addClass('row').attr('id', 'QuizButton').appendTo('#QuizContent');
            setButtons();
		}
	}

    function initQuiz(){
/*
        $.getJSON( "quiz.json", {} )
        .done(function( result ) {
            localStorage.setItem('QuizStore', JSON.stringify(result));
        })
        .fail(function( jqxhr, textStatus, error ) {
            var err = textStatus + ", " + error;
            console.log( "Request Failed: " + err );
        });
*/
        $.getJSON("https://raw.githubusercontent.com/faizmazlan/faizmazlan.github.io/master/aws-saa-co2/quiz.json", function(result){
            localStorage.setItem('QuizStore', JSON.stringify(result));
        });
    
        //var test = JSON.parse(localStorage.getItem('QuizStore'));
        //alert(test.QuizCode);
        // alert(localStorage.getItem('QuizStore'));

        if( !!localStorage.getItem('QuizStore') ){
            var Quiz = JSON.parse(localStorage.getItem('QuizStore'));
            var QuizCode = Quiz.QuizCode;
            var QuizTitle = Quiz.QuizTitle;
            var QuizDescription = Quiz.QuizDescription;
            var QuizQuestions = Quiz.QuizQuestions;  

            //add quiz title and description
            if (typeof QuizTitle !== "undefined" && $.type(QuizTitle) === "string") {
                $(document.createElement('h2')).text(QuizTitle).appendTo('#QuizHeader');
                $('#PageTitle').text(QuizTitle);
            }
            if (typeof QuizDescription !== "undefined" && $.type(QuizDescription) === "string") {
                $(document.createElement('p')).addClass('lead').text(QuizDescription).appendTo('#QuizHeader');
            }
            
            $(document.createElement('hr')).addClass('mb-4').appendTo('#QuizContent');
            //$(document.createElement('p')).addClass('text-center').text(QuizDescription).appendTo('#QuizContent');
            //$(document.createElement('br')).appendTo('#QuizContent');
            $(document.createElement('div')).addClass('row').attr('id', 'QuizStartRow1').appendTo('#QuizContent');
            $(document.createElement('div')).addClass('col').attr('id', 'QuizStartCol11').appendTo('#QuizStartRow1');
            $(document.createElement('div')).addClass('col').attr('id', 'QuizStartCol12').appendTo('#QuizStartRow1');
            $(document.createElement('div')).addClass('col').attr('id', 'QuizStartCol13').appendTo('#QuizStartRow1');
            $(document.createElement('button')).addClass('btn btn-block').addClass('btn-primary').attr('id', 'ButtonStart').text('Start').appendTo('#QuizStartCol12');
            $(document.createElement('hr')).addClass('mb-4').appendTo('#QuizContent');
            $('#ButtonStart').on('click', function () {
                startQuiz();
            });
        } else {
            $(document.createElement('h2')).addClass('text-danger').text('Error!').appendTo('#QuizHeader');
            $(document.createElement('p')).addClass('lead').text('Unable to load the questions.').appendTo('#QuizHeader');
        }

    }

    initQuiz();
});

</script>

<!-- JS quiz functions - end -->

</head>

<body class="bg-light">
    <div class="container">
        <div id="QuizHeader" class="py-4 text-center"></div>
            <div class="row">
                <div id="QuizContent" class="col">
                </div>
            </div>
    </div>
    <div class="footer py-4 text-center">
        <p class="text-secondary">© 2020 @MatBuang</p>
    </div>
<!-- Bootstrap core JavaScript
================================================== 
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://getbootstrap.com/docs/4.1/assets/js/vendor/popper.min.js"></script>
<script src="https://getbootstrap.com/docs/4.1/assets/js/vendor/holder.min.js"></script>
<script src="https://getbootstrap.com/docs/4.1/dist/js/bootstrap.min.js"></script>
-->
</body>
</html>
